(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1264d021"],{"02f4":function(t,e,n){var r=n("4588"),a=n("be13");t.exports=function(t){return function(e,n){var i,c,o=String(a(e)),s=r(n),u=o.length;return s<0||s>=u?t?"":void 0:(i=o.charCodeAt(s),i<55296||i>56319||s+1===u||(c=o.charCodeAt(s+1))<56320||c>57343?t?o.charAt(s):i:t?o.slice(s,s+2):c-56320+(i-55296<<10)+65536)}}},"0390":function(t,e,n){"use strict";var r=n("02f4")(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"11e9":function(t,e,n){var r=n("52a7"),a=n("4630"),i=n("6821"),c=n("6a99"),o=n("69a8"),s=n("c69a"),u=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?u:function(t,e){if(t=i(t),e=c(e,!0),s)try{return u(t,e)}catch(n){}if(o(t,e))return a(!r.f.call(t,e),t[e])}},"214f":function(t,e,n){"use strict";n("b0c5");var r=n("2aba"),a=n("32e9"),i=n("79e5"),c=n("be13"),o=n("2b4c"),s=n("520a"),u=o("species"),l=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var p=o(t),d=!i((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),h=d?!i((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[u]=function(){return n}),n[p](""),!e})):void 0;if(!d||!h||"replace"===t&&!l||"split"===t&&!f){var g=/./[p],v=n(c,p,""[t],(function(t,e,n,r,a){return e.exec===s?d&&!a?{done:!0,value:g.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}})),m=v[0],b=v[1];r(String.prototype,t,m),a(RegExp.prototype,p,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}}},"28a5":function(t,e,n){"use strict";var r=n("aae3"),a=n("cb7c"),i=n("ebd6"),c=n("0390"),o=n("9def"),s=n("5f1b"),u=n("520a"),l=n("79e5"),f=Math.min,p=[].push,d="split",h="length",g="lastIndex",v=4294967295,m=!l((function(){RegExp(v,"y")}));n("214f")("split",2,(function(t,e,n,l){var b;return b="c"=="abbc"[d](/(b)*/)[1]||4!="test"[d](/(?:)/,-1)[h]||2!="ab"[d](/(?:ab)*/)[h]||4!="."[d](/(.?)(.?)/)[h]||"."[d](/()()/)[h]>1||""[d](/.?/)[h]?function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(a,t,e);var i,c,o,s=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,d=void 0===e?v:e>>>0,m=new RegExp(t.source,l+"g");while(i=u.call(m,a)){if(c=m[g],c>f&&(s.push(a.slice(f,i.index)),i[h]>1&&i.index<a[h]&&p.apply(s,i.slice(1)),o=i[0][h],f=c,s[h]>=d))break;m[g]===i.index&&m[g]++}return f===a[h]?!o&&m.test("")||s.push(""):s.push(a.slice(f)),s[h]>d?s.slice(0,d):s}:"0"[d](void 0,0)[h]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var a=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,a,r):b.call(String(a),n,r)},function(t,e){var r=l(b,t,this,e,b!==n);if(r.done)return r.value;var u=a(t),p=String(this),d=i(u,RegExp),h=u.unicode,g=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(m?"y":"g"),x=new d(m?u:"^(?:"+u.source+")",g),y=void 0===e?v:e>>>0;if(0===y)return[];if(0===p.length)return null===s(x,p)?[p]:[];var w=0,N=0,_=[];while(N<p.length){x.lastIndex=m?N:0;var R,k=s(x,m?p:p.slice(N));if(null===k||(R=f(o(x.lastIndex+(m?0:N)),p.length))===w)N=c(p,N,h);else{if(_.push(p.slice(w,N)),_.length===y)return _;for(var A=1;A<=k.length-1;A++)if(_.push(k[A]),_.length===y)return _;N=w=R}}return _.push(p.slice(w)),_}]}))},"2f21":function(t,e,n){"use strict";var r=n("79e5");t.exports=function(t,e){return!!t&&r((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"520a":function(t,e,n){"use strict";var r=n("0bfb"),a=RegExp.prototype.exec,i=String.prototype.replace,c=a,o="lastIndex",s=function(){var t=/a/,e=/b*/g;return a.call(t,"a"),a.call(e,"a"),0!==t[o]||0!==e[o]}(),u=void 0!==/()??/.exec("")[1],l=s||u;l&&(c=function(t){var e,n,c,l,f=this;return u&&(n=new RegExp("^"+f.source+"$(?!\\s)",r.call(f))),s&&(e=f[o]),c=a.call(f,t),s&&c&&(f[o]=f.global?c.index+c[0].length:e),u&&c&&c.length>1&&i.call(c[0],n,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(c[l]=void 0)})),c}),t.exports=c},"55dd":function(t,e,n){"use strict";var r=n("5ca1"),a=n("d8e8"),i=n("4bf8"),c=n("79e5"),o=[].sort,s=[1,2,3];r(r.P+r.F*(c((function(){s.sort(void 0)}))||!c((function(){s.sort(null)}))||!n("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(i(this)):o.call(i(this),a(t))}})},"5dbc":function(t,e,n){var r=n("d3f4"),a=n("8b97").set;t.exports=function(t,e,n){var i,c=e.constructor;return c!==n&&"function"==typeof c&&(i=c.prototype)!==n.prototype&&r(i)&&a&&a(t,i),t}},"5f1b":function(t,e,n){"use strict";var r=n("23c6"),a=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var i=n.call(t,e);if("object"!==typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(t,e)}},"8b97":function(t,e,n){var r=n("d3f4"),a=n("cb7c"),i=function(t,e){if(a(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:i}},9093:function(t,e,n){var r=n("ce10"),a=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,a)}},9569:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-row",{attrs:{type:"flex",justify:"center"}},[n("van-col",{attrs:{span:"24"}},[n("van-nav-bar",{attrs:{title:"发送详情","left-text":"返回"},on:{"click-left":t.goBack}})],1)],1),n("van-row",{staticClass:"count-wrap",attrs:{type:"flex"}},[n("van-list",{staticClass:"van-list-container",attrs:{finished:t.finished,"finished-text":"没有更多了",span:24},on:{load:function(e){return t.queryReceiveRecord(t.currentNum-1)}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[n("van-cell",[n("span",{staticClass:"fl",staticStyle:{width:"45%"}},[t._v("时间")]),n("span",{staticClass:"fl",staticStyle:{width:"20%"}},[t._v("总额")]),n("span",{staticClass:"fl",staticStyle:{width:"20%"}},[t._v("总数")]),n("span",{staticClass:"fl",staticStyle:{width:"15%"}},[t._v("状态")])]),t._l(t.packetList,(function(e){return n("van-cell",{key:e.index},[n("span",{on:{click:function(n){return t.getPacketDetails(e.packetAddr)}}},[n("span",{staticClass:"fl name-wrap",staticStyle:{width:"45%"}},[n("span",{staticClass:"db font_14 "},[t._v(t._s(e.startTimeStr))])]),n("span",{staticClass:"fl name-wrap",staticStyle:{width:"20%"}},[n("span",{staticClass:"db font_14"},[t._v(t._s(t._f("handleAmount")(e.totalAmount)))])]),n("span",{staticClass:"fl name-wrap",staticStyle:{width:"15%","text-align":"center"}},[n("span",{staticClass:"db font_14"},[t._v(" "+t._s(e.totalNumber))])])]),n("span",{staticClass:"fl name-wrap",staticStyle:{width:"20%","text-align":"center"}},[e.expired&&e.remainAmount>0?n("span",{staticClass:"db font_14 ",staticStyle:{color:"dodgerblue"},on:{click:function(n){return t.recyclePacket(e.packetAddr)}}},[t._v("回收")]):!e.expired&&e.remainAmount>0?n("span",{staticClass:"db font_14 "},[t._v("领取中")]):0==e.remainAmount?n("span",{staticClass:"db font_14 "},[t._v("已领完")]):t._e()])])}))],2)],1)],1)},a=[],i=(n("55dd"),n("28a5"),n("c5f6"),n("6b54"),n("e17f"),n("2241")),c=(n("96cf"),n("3b8d")),o={name:"index",data:function(){return{loading:!1,finished:!1,account:"0x0",packetList:[],createTotalNumber:0,currentNum:0,contract:{address:this.$contract_address,instance:null}}},created:function(){this.initInstance(),this.getUrlQuery(),this.perQueryReceiveRecord()},mounted:function(){},methods:{recyclePacket:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,i,c=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this,n=this.contract.instance.recyclePacket,console.log(this.account),r=n.getData(e),console.log(r),a=this.$chain3.mc.estimateGas({to:this.contract.address,data:r})+2e4,console.log("gasLimit",a),console.log("system",this.$system),i={from:this.account,to:this.contract.address,gasPrice:"ios"==this.$system?this.getGasPrice():this.$Web3.utils.toHex(this.getGasPrice()),gasLimit:"ios"==this.$system?a:this.$Web3.utils.toHex(a),data:r,value:"0x0",chainId:"0x63",via:"0x",shardingFlag:"0x0"},console.log("query",i),this.$tp.sendMoacTransaction(i).then((function(t){if(console.log("sendMoacTransaction",t),t.result){console.log("sendMoacTransaction",t);var e=t.data,n=c.$chain3.mc.getTransactionReceipt(e);n&&console.log("receipt:",n),c.$toast("操作成功,请等待链上确认！")}if(!t.result)return"replacement transaction underpriced"==t.data?(c.$toast("其他交易正在确认中，请稍后！"),!1):(c.$toast(t.data),!1)})).catch((function(t){console.log("error"),console.log(t)}));case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initInstance:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.contract.instance=this.$chain3.mc.contract(this.$RedPacketArtifact.abi).at(this.contract.address),window.instance=this.contract.instance;case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getUrlQuery:function(){var t=this;this.account=this.$route.query.account,this.account.indexOf("0x")<0&&(console.log(this.account.indexOf("0x")),i["a"].alert({message:"请选择钱包地址"}).then((function(){t.goBack()})))},perQueryReceiveRecord:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this,this.contract.instance.queryCreatedRecord.call(this.account,0,(function(t,n){if(t)console.log(t);else{var r=n.toString(),a="0x"+r.slice(10);if(0!=r.indexOf("0x08c379a0")){var i=e.$Web3.eth.abi.decodeParameters(e.contract.instance.abi[10].outputs,n);return e.createTotalNumber=i.totalNum,e.currentNum=i.totalNum,console.log("that.createTotalNumber = "+e.createTotalNumber),console.log("that.currentNum = "+e.currentNum),void e.queryReceiveRecord(e.currentNum-1)}var c=e.$Web3.eth.abi.decodeParameter("string",a);console.log(c)}console.log("that.createTotalNumber = 0;"),e.createTotalNumber=0,e.finished=!0}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),queryReceiveRecord:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n=this,console.log("queryReceiveRecord-----------"),r=e;r>=(e-10>0?e-10:0);r--)console.log("queryCreatedRecord  "+r),n.contract.instance.queryCreatedRecord.call(n.account,r,(function(t,e){if(t)console.log("err"),console.log(t);else{var r=e.toString(),a="0x"+r.slice(10);if(0==r.indexOf("0x08c379a0")){var i=n.$Web3.eth.abi.decodeParameter("string",a);console.log(i)}else{var c=n.$Web3.eth.abi.decodeParameters(n.contract.instance.abi[10].outputs,e);console.log(c);var o={};o.packetAddr=c.packetAddr,o.remainAmount=n.$Web3.utils.fromWei(c.remainAmount),o.remainNumber=c.remainNumber,o.totalAmount=n.$Web3.utils.fromWei(c.totalAmount),o.totalNumber=c.totalNumber,o.description=c.description,o.expired=Number(c.startTime)+86400<(new Date).getTime()/1e3,o.startTime=new Date(1e3*c.startTime),o.startTimeStr=o.startTime.toLocaleDateString()+" "+o.startTime.toTimeString().split(" ")[0].slice(0,5),n.createTotalNumber=c.totalNum,n.pushList(o)}}}));this.loading=!1;case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getPacketDetails:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$router.push({path:"/packet-details",query:{addr:e,account:this.account}});case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),goBack:function(){history.go(-1)},getGasPrice:function(){var t=this.$chain3.mc.gasPrice;return t.toString()},pushList:function(t){this.packetList.push(t);var e={};this.packetList=this.packetList.reduce((function(t,n){return!e[n.packetAddr]&&(e[n.packetAddr]=t.push(n)),t}),[]),this.packetList.sort((function(t,e){return e.startTime-t.startTime})),this.currentNum=this.createTotalNumber-this.packetList.length,console.log(this.currentNum+"------------"),this.packetList.length>=this.createTotalNumber&&(this.finished=!0,console.log("finished"))}},filters:{handleStr:function(t){if(t.length>12){var e=t.substring(0,8),n=t.substr(t.length-4,4),r=e+"..."+n;return r.toLowerCase()}return t},handleAmount:function(t){return Number(t).toFixed(3)},parseNum:function(t){return parseFloat(t)}}},s=o,u=(n("abbc"),n("2877")),l=Object(u["a"])(s,r,a,!1,null,"ed5733b6",null);e["default"]=l.exports},aa77:function(t,e,n){var r=n("5ca1"),a=n("be13"),i=n("79e5"),c=n("fdef"),o="["+c+"]",s="​",u=RegExp("^"+o+o+"*"),l=RegExp(o+o+"*$"),f=function(t,e,n){var a={},o=i((function(){return!!c[t]()||s[t]()!=s})),u=a[t]=o?e(p):c[t];n&&(a[n]=u),r(r.P+r.F*o,"String",a)},p=f.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=f},aae3:function(t,e,n){var r=n("d3f4"),a=n("2d95"),i=n("2b4c")("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==a(t))}},abbc:function(t,e,n){"use strict";var r=n("df3a"),a=n.n(r);a.a},b0c5:function(t,e,n){"use strict";var r=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},c5f6:function(t,e,n){"use strict";var r=n("7726"),a=n("69a8"),i=n("2d95"),c=n("5dbc"),o=n("6a99"),s=n("79e5"),u=n("9093").f,l=n("11e9").f,f=n("86cc").f,p=n("aa77").trim,d="Number",h=r[d],g=h,v=h.prototype,m=i(n("2aeb6")(v))==d,b="trim"in String.prototype,x=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():p(e,3);var n,r,a,i=e.charCodeAt(0);if(43===i||45===i){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+e}for(var c,s=e.slice(2),u=0,l=s.length;u<l;u++)if(c=s.charCodeAt(u),c<48||c>a)return NaN;return parseInt(s,r)}}return+e};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof h&&(m?s((function(){v.valueOf.call(n)})):i(n)!=d)?c(new g(x(e)),n,h):x(e)};for(var y,w=n("9e1e")?u(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;w.length>N;N++)a(g,y=w[N])&&!a(h,y)&&f(h,y,l(g,y));h.prototype=v,v.constructor=h,n("2aba")(r,d,h)}},df3a:function(t,e,n){},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-1264d021.cbea0254.js.map